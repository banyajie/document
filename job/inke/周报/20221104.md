#### 3.6.20版本需求

- 游戏防沉迷                2天
  - 入口
  - 用户实名认证查询
    - 用户实名认证接入 - 对接api
    - 
- 游戏相关优化
  - 炸弹猫删除换牌按钮
  - 萌猫匹配规则      0.5天    杨阳
    - 服务
    - 
  - 猜猜乐？
  - x
  - x
  - 游戏顺序调整
    - 服务
  - 狼人排队入口
    - 服务
    - 客户端
- 匹配页优化
  - 服务
    - 增加两个入口（新老版本兼容）
  - 客户端
    - 
- 私信页增加卡片                                     已部署测试
  - 服务
    - 个人基础资料
    - cp信息
    - 守护信息
  - 客户端
    - 展示规则
    - 数据埋点
- 婚礼房                                                      已部署测试，上线要先建sql表
  - 服务
    - 增加奖励记录，新增db记录
    - 奖励下发限制
    - 奖励下发私信
- 房间封面
  - 服务
    - 
  - 客户端







3.6.10





```sql


CREATE TABLE `wedding_award_00` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '自增id',
  `uid` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '用户ID',
  `live_id` varchar(16) DEFAULT '' COMMENT '直播ID',
  `seq_id` int(8) unsigned NOT NULL DEFAULT '1' COMMENT '婚礼场次ID',
  `level` int(4) unsigned NOT NULL DEFAULT '0' COMMENT '当前等级',
  `props_id` int(8) unsigned NOT NULL DEFAULT '1' COMMENT '物品ID',
  `props_name` varchar(32) DEFAULT '' COMMENT '物品名称',
  `create_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `uid` (`uid`)
) ENGINE=InnoDB AUTO_INCREMENT=62153 DEFAULT CHARSET=utf8mb4 COMMENT='用户奖励信息';


```







##### 3.6.30版本需求

- 匹配页需求            0.5天 - 1天

  - 优化匹配页弹窗

    - 用户资料完善

    - 最近在玩

    - 动态

  - 弹窗次数限制

    - 1.10min内，弹窗最多排10人；

      2.同时间段内最多接收10条消息；超过消息不进入队列；

- 匹配页跳转          0.5天 

  - 白名单cpdd房间

- 推荐数据迁移      1 天

  - 

- 聊天室收藏          3天

  - 基础架构 - 收藏服务（db - 用户收藏数据）
  - 收藏接口
    - vip（房主）判断、db、限制、公聊
  - 取消收藏
    - 
  - 收藏tab页
    - 正在直播的房间展示 - ？？
    - 当房主VIP过期/取消24h白名单的房间，将会在用户的“收藏”列表中消失 ？
    - 空页面
  - 收藏列表页
    - 个人主页增加入口
    - 排序规则、总数量....
  - fri进房信息 - imcenter.room.logic

  

  







#### 3.6.32

- 好友达成优化
  - 搭建用户资料代理层服务 - 收拢入口
    - user.nvwa.gateway
  - 默认头像
    - 个人资料-客态页  -  user.center.logic
    - 私聊-社交卡片.  -   user.center.logic
    - 找TA玩   -  hall.center.logic
    - 私聊 - 列表   -    im.message.hook
    - 私聊  -  内容    -  同列表
    - 匹配弹窗     -     user.match.base
    - cpdd匹配页-6个推荐头像；  -   user.match.base
    - 聊天室 - 麦上用户.    live.voiceroom.logic
    - 聊天室 - 公屏聊天     live.voiceroom.logic
    - 聊天室 - 房间队列.     live.voiceroom.logic          live.room.base
    - 聊天室 - 礼物面板.   live.voiceroom.logic
    - 聊天室 - 小资料卡    live.voiceroom.logic
    - ..
- 一键打招呼任务 - 已有行为打点
  - 匹配服务增加打点 
- 恋爱物语跳转 - 添加接口
  - 增加头像
  - 动态下发跳转地址



##### 3.6.40

- 家族长奖励
  - 

- 推荐开关
  - 用户资料
  - 推荐用户物料
- 亲密印记
  - 入口
    - 是否展示入口 -         --    im-list
    - 条件 - 双向好友
    - 已解锁的印记信息
  - 好友印记主页
    - 条件 - 是否还是双向好友
    - 亲密度（守护值 - 双向）   
    - 等级勋章
      - 亲密度（等级、图片）
    - 互为好友天数
    - 
    - 印记信息
      - 亲密印记
        - 印记信息列表
          - 条件（连续xxx）
          - 已完成
          - 每个级别的信息（名字、icon、是否达成、奖励信息（？？？））
          - 
      - 礼物数量 ？ 
      - 礼物明细 ？
  - 全部印记入口
    - 入口
      - 消息列
      - 已和xx好友点亮
    - 客态页
      - 用户信息、印记数量
    - 全部印记列表
      - 用户头像，昵称，性别，地域，印记，点亮信息，熄灭信息，发消息按钮
      - 列表排序规则 - ？
      - 印记状态、点亮、熄灭数据
  - 印记外显
    - 消息列表
    - 私聊
    - 点亮、熄灭系统消息
  - 印记规则
    - 点亮
      - 每个系列的印记连续达成2/3/5/7天的互动即可点亮
      - 印记数量
        - 当用户连续7天互动点亮了火龙/四叶草/巨轮/夜光杯任意印记后，第8天开始，每持续互动1天，则该印记的收集数量+1
        - 若互动行为中断，印记熄灭后，已经累计的印记数量将保留，再次点亮后可继续累计
    - 熄灭
      - 0点检查今日是否达成
      - 
    - 奖励
      - 每种奖励只有在首次点亮印记时可领取
      - 



kafka数据：

好友关系变动kafka

发送消息（私信）kafka

送礼kafka



定时检查逻辑：

- 定时检查是否



好友印记服务

- user.signet.base
- 
- im.message.hook
- 









#### 3.6.4

###### 王者擂台赛

- 基础功能

  - 主页功能
    - 基本配置（标题、副标题、、、）
    - 最近100天奖励弹幕循环播放
    - 个人奖励信息、个人门票信息（入口）
    - 账号绑定信息
    - 已报名赛事信息
    - 当前赛事列表（分页）

  - 赛事
    - 创建赛事
      - 拉取赛事配置信息（区服、地图、模式、段位要求、模式、时间）、奖励信息等
      - 创建
        - 是否绑定游戏账号
        - 创建成功后小助手消息
        - 是否门票足够
        - 时间
    - 赛事详情 （场次明细）
      - 赛事配置信息
      - 奖励信息
      - 发起人资料
      - 状态
        - 报名有效期
        - 报名结束
        - 游戏结束
      - 个人状态
        - 是否报名
          - 游戏房间的跳转信息
        - 是否开始
          - 游戏数据
    - 报名
      - 门票
      - 
    - 我的赛事
      - 进行中
        - 已报名的、自己创建的
      - 历史记录
        - 
  - 奖励记录
  - 绑定账号
  - 门票记录
    - 活动上线后，每个用户默认有1张门票；
  - 入口

- 存储

  - 基本配置
    - 初级场、消耗、游戏图片、、、、
  - 赛事
  - 赛事报名数据、游戏结果数据
  - 用户报名信息
  - 用户奖励记录
  - 用户门票获取记录

- 







1、增加组长语音房呆10分钟的家族任务 

- 判断房间房主是否是家族族长

2、家族成员周活跃值转换为盲盒抽奖次数（200活跃换一次，满200自动兑换） 

- 发抽奖券
- 

3、更新盲盒抽取的奖励 

- 

4、传说及以下/史诗/至尊/王者每天免费盲盒次数修改为1/2/3/5次，维护资金修改为500/1000/2000/5000每天 

- 根据等级扣减家族资金

5、史诗/至尊/王者成员上限调整为200/300/500，王者长老上限8人 

- 

5、盲盒抽取限制（加入家族满24小时且家族周活跃不低于20）

- 加一个接口

 6、新增“王者”家族等级，活跃176万，资金120万，家族活跃达到升级条件后可在不提升家族等级的情况下继续累积活跃值

- 增加配置





已上线：

家族长房间信息

live.voiceroom.logic

客户端横滑优化

live.voiceroom.logic



未上线：

盲盒需求：

db：

- 增加字段（家族配置信息（维护资金、免费盲盒次数）
- 增加王者等级配置

服务

- im.family.base
- im.family.logic 



图标设计的服务：

im.message.hook

live.voiceroom.logic

dymoment







春节活动需求：

- 活动版本（版本号、活动时间）更新

- 物品配置
- 奖励配置
- 礼物id更换
- 默认背景更换







游戏：

go mod tidy

go mod vendor





```go

module gosimple

go 1.13

require (
	git.inke.cn/BackendPlatform/golang v1.2.4
	git.inke.cn/coolive/socialgame/game/server/base/game_errors v0.0.0-20210902100936-70bd8e08fe84
	git.inke.cn/coolive/socialgame/game/server/base/socialgame.nationalpolicy.service v0.0.0-20220222101546-05a4933b9c2e

	// 本地服务
	git.inke.cn/coolive/socialgame/game/server/base/socialgame.rivet.service v0.0.0-20220222094150-5dea8caf1aa6
	git.inke.cn/coolive/socialgame/game/server/base/socialgame.roommanage.service v0.0.0-20210715070641-204f8b93c190
	git.inke.cn/coolive/socialgame/game/server/play/play.core.service v0.0.0-20210629111405-1699e1b7092e
	git.inke.cn/coolive/socialgame/game/server/utils/cell v0.0.0-20211027110801-3bd481775780
	git.inke.cn/coolive/socialgame/social/server/commerce/commerce.gift.base v0.0.0-20201216103135-86a8f45eefe4
	git.inke.cn/inkelogic/daenerys v1.0.8
	git.inke.cn/inkelogic/rpc-go v1.1.3
	git.inke.cn/nvwa/server/ceres/sdk v0.0.0-20211027032701-94df868dfa8d
	git.inke.cn/nvwa/server/commlib v0.0.0-20220218092805-639870a15b51
	git.inke.cn/nvwa/server/user/sdk v0.0.0-20200724081540-1072c90fcec7
	github.com/360EntSecGroup-Skylar/excelize/v2 v2.3.1
	github.com/Unknwon/com v0.0.0-20190321035513-0fed4efef755
	github.com/bsm/redislock v0.4.0
	github.com/davecgh/go-spew v1.1.1
	github.com/go-redis/redis v6.15.9+incompatible
	github.com/golang/protobuf v1.5.2
	github.com/google/uuid v1.3.0
	github.com/gorilla/websocket v1.4.2
	github.com/grpc-ecosystem/go-grpc-middleware v1.2.2
	github.com/jinzhu/gorm v1.9.12
	github.com/mitchellh/mapstructure v1.4.1
	github.com/onsi/ginkgo v1.13.0 // indirect
	github.com/robfig/cron v1.2.0
	github.com/segmentio/ksuid v1.0.4
	github.com/sirupsen/logrus v1.6.0
	github.com/unknwon/com v1.0.1
	golang.org/x/net v0.0.0-20210908191846-a5e095526f91
	google.golang.org/grpc v1.32.0
)

replace github.com/uber-go/atomic => github.com/uber-go/atomic v1.4.0

replace github.com/codahale/hdrhistogram => github.com/HdrHistogram/hdrhistogram-go v0.9.0

```





- 游戏开局
  - 
- 呆呆鸟
  - 被投票出去
- 游戏结算
  - 
- 战绩
  - 





开发：

- 增加身份枚举
- room.go
  - 随机分配玩家身份
- Player
  - PlayerGameInfo
    - 是否是投票投出去的，会议结束的时候赋值
- MurderWin
  - 
- PeopleWin
  - 增加呆呆鸭赢的判断方法
    - 文案枚举
- 经验值



异常case：

呆呆鸟-离线

呆呆鸟-任务



加拿大鹅

- 被杀 - 自动发起会议 - 服务端

网红鹅

- 被杀 - 发广播文案
  - 客户端检查
  - 



加结构体

- 记录协议变动
- 记录阵营判断
  - 判断时区分阵营和角色
- 加注释

- 判断胜利失败





平台数据库

10.100.11.156    当前配置：2c 4G    升级后配置：4c  8G

10.100.10.170   当前配置：4c 8G  磁盘200G   升级后配置：4c 16G  磁盘 300G

游戏数据库：

10.100.52.5   当前配置：2c 4G    升级后配置：4c  8G

10.100.20.41  当前配置：2c 4G    升级后配置：4c  8G













https://h5.thlrs.com/innerapp/lantern-festival/index.html



			"img_url": "https://img.thlrs.com/sys/MTY3NTM5NDAzODcxOSMgNzkjcG5n.png",
				"radius": 16,
				"schema": "https://h5.thlrs.com/innerapp/lantern-festival/index.html",
				

17253586,17085977





- 成本优化

  - 中台

    - 用户系统（29000）

      - 了解计费标准

        - 月度的qps峰值（2w左右） 120w qpm

        - 用户资料

          - 批量获取10qpm
          - session 10qpm

        - 用户关系

        - 

        - 用户登陆、注册

          - 绑定关系

        - 黑名单

        - 用户心跳

          

      - 方案

        - 1：用户中台服务迁移
        - 2：代理

  - 多媒体

    - 实时流翻译（42000）（用途 - 审核）
      - 音频直播间审核后台会使用语音翻译的文字结果来过敏感词库，判断出违规；在根据录播作最后的校对。
    - 录播 （38000）
      - 多流录播（用途 - 审核）
      - 混流录播（用途 - 高光时刻）

  - 风控

    - 朱雀系统（2000）
    - 实名认证（人脸）（19000）
      - 

  - 大数据

    - 





成本优化







#### 情人节活动

> activity.center.logic
>
> - 生成新的活动ID
> - 奖励配置
> - 排行榜配置

#### 家族任务

> 任务配置
>
> - 观看家族长直播30分钟
>
> - ```toml
>       {product="socialgame",activityId=3,groupId=3012,questId=30000012,nextQuestId=0,triggerEventId=2026,target=1800,questName="观看族长聊天室30min"},
>   
>          {product="socialgame",activityId=3,groupId=3012,nextGroupId=0,questType=1,expireTime=0,rewardGroupId=3012,giveRewardWay=1,whenHidden=0,groupName="观看族长聊天室30min",icon="http://ws.img.imilive.cn/rn/image/task/phone_icon.png",desc="谈笑风声，欢聚一堂",detail="",skip="sg://m.yk.com/family/refuel_bag"},
>   
>   奖励
>   300006     家族活跃20
>   310006     家族资金20
>   
>   
>   event_id : 2029
>   
>   
>   
>   
>   ali-f-inf-kafka-test23.bj:9092,ali-f-inf-kafka-test24.bj:9092,ali-f-inf-kafka-test25.bj:9092,ali-f-inf-kafka-test26.bj:9092,ali-f-inf-kafka-test27.bj:9092
>     
>     
>   
>   ```
>
> - 
>
> 任务触发
>
> - 检查用户心跳、获取家族信息。获取家族长直播信息等
>
> 其余任务调整

#### 聊天室集市

> - 入口
>   - 房主白名单（白名单房主房间显示入口），进房拉取是否展示该入口
>   - 更多活动入口配置
>   - 白名单逻辑
>     - 白名单取消后关闭集市信息、清理集市数据、集市商品退回逻辑
>   - /live/market/write_uid_list
>   - 
> - 集市主页
>   - 集市基本信息（集市房主uid、名字、等级）
>   - 集市商品信息
>     - 卖方、礼物信息（礼物价值、魅力值、售价、名字、图片、有效期？）
>     - 排序规则（礼物价值倒序、出手价值）
>   - 房主视角
>     - 档口解锁信息
>     - 集市升级档位信息（下一个档位信息、权益）
> - 购买集市商品
>   - 自己不可购买自己售卖商品
>   - 校验金币是否足够、是否有库存等
>   - 发放背包
>   - 交易记录
>     - 买方、卖方交易记录
>   - 聊天室公聊
>   - 过期时间固定
> - 房主 - 集市管理
>   - 档口解锁
>     - 金币校验
>     - 增加档口（？？）
>   - 升级
>     - 金币校验
>     - 更新集市等级信息
>     - 增加档口（？？）
> - 我的摊位
>   - 主页
>     - 已上架商品信息
>       - 是否已售
>   - 交易记录
>     - 最近15天
>     - 用户购买记录、用户卖出记录
>     - 用户上架商品退回记录
>   - 上架商品
>     - 最多两个商品
>     - 背包礼物、查询礼物详细信息、
>     - 定价规则
>     - 扣减管理费、根据集市等级给房主摊位费
>     - 上架
>     - 聊天室公聊（）
>   - 上架商品的定时检查逻辑
>     - 退回商品时过期时间不足24小时算24小时
> - 预估排期
>   - 基础架构搭建 1d
>     - 集市维度
>       - 集市信息（房主uid、等级、）
>       - 集市摊位信息（摊位ID、商品信息、是否售出等）
>     - 用户维度
>       - 已上架商品信息
>       - 交易记录
>     - 
>   - 业务逻辑
>     - 集市管理
>       - 解锁
>       - 升级
>     - 用户
>       - 上架
>       - 购买
>     - 脚本
>       - 商品检查（是否过期）
>     - api
>       - 集市页面
>       - 我的页面
>       - 交易记录

#### 家族调整

> - 增加家族等级档位
> - 周活跃
>   - 重写逻辑，根据家族等级以及档位发放奖励
> - 家族活跃调整

#### ios发版

> 屏蔽cpdd tab
>
> 推荐数据过滤cpdd数据
>
> 动态配置
>
> - /switch/ios/cpdd/show
> - 

其他：

大v周榜白名单用户解除







```shel
收礼人魅力值
送出人财富值

610) "14713077"
3611) "10478578"
3612) "15631752"
3613) "4109018"
3614) "10238635"


11596	13822812:13804752	13804752	13822812	597	1	0	2023-02-10 00:40:05	2023-02-10 00:41:35
11598	15854320:14644728	14644728	15854320	597	1	0	2023-02-10 00:52:15	2023-02-10 00:52:15
11601	17337380:6656888	6656888	17337380	597	0	0	2023-02-10 07:35:50	2023-02-10 08:52:48
11604	18613552:17833544	18613552	17833544	597	1	0	2023-02-10 08:41:59	2023-02-10 08:43:22
11747	16941872:15514801	16941872	15514801	597	1	0	2023-02-10 06:34:40	2023-02-10 06:42:16
13051	15446071:14830042	15446071	14830042	597	0	0	2023-02-10 00:31:42	2023-02-10 06:38:06
13052	12032327:4109018	4109018	12032327	597	0	0	2023-02-10 00:34:25	2023-02-10 01:45:28
13053	11243210:10822218	10822218	11243210	597	0	0	2023-02-10 00:34:44	2023-02-10 09:12:40
13054	12284540:10143130	10143130	12284540	597	0	0	2023-02-10 00:36:14	2023-02-10 00:50:27
13055	18210470:16923130	16923130	18210470	597	1	0	2023-02-10 00:36:51	2023-02-10 02:12:40
12210	14287975:11903659	14287975	11903659	597	1	0	2023-02-10 00:35:39	2023-02-10 09:24:59
12211	13610456:11848435	13610456	11848435	597	1	0	2023-02-10 01:05:00	2023-02-10 01:05:00
12213	15904213:13532051	13532051	15904213	597	1	0	2023-02-10 08:09:27	2023-02-10 08:09:27
11824	11240354:4323460	4323460	11240354	597	1	0	2023-02-10 01:05:48	2023-02-10 01:09:30
12262	17659208:8732309	17659208	8732309	597	1	0	2023-02-10 00:34:36	2023-02-10 01:10:08
12263	17835047:17526141	17526141	17835047	597	0	0	2023-02-10 00:37:31	2023-02-10 00:41:53
12077	9698938:9686606	9686606	9698938	597	0	0	2023-02-10 00:37:13	2023-02-10 00:37:38
12079	18519684:17564014	18519684	17564014	597	1	0	2023-02-10 01:13:54	2023-02-10 01:13:54
12081	16412235:12651806	16412235	12651806	597	0	0	2023-02-10 01:34:38	2023-02-10 01:35:00
12221	15430202:10064775	10064775	15430202	597	0	0	2023-02-10 00:36:31	2023-02-10 01:00:03
12222	11629649:5085167	5085167	11629649	597	1	0	2023-02-10 00:51:45	2023-02-10 00:58:44
12223	17980313:13729383	13729383	17980313	597	0	0	2023-02-10 01:57:33	2023-02-10 04:02:57


5548273	14830042	14830042	234	2023-02-10 00:06:09	2023-02-10 00:06:09
5548278	14830042	15446071	234	2023-02-10 00:06:28	2023-02-10 00:06:28
5548283	12032327	4109018	234	2023-02-10 00:06:36	2023-02-10 00:06:36
5548288	4109018	12032327	234	2023-02-10 00:06:42	2023-02-10 00:06:42
5548290	14287975	11903659	234	2023-02-10 00:06:47	2023-02-10 00:06:47
5548297	16923130	16923130	234	2023-02-10 00:07:01	2023-02-10 00:07:01
5548298	16923130	18210470	234	2023-02-10 00:07:14	2023-02-10 00:07:14
5548300	14287975	14287975	234	2023-02-10 00:07:16	2023-02-10 00:07:16
5548303	17526141	17835047	234	2023-02-10 00:07:19	2023-02-10 00:07:19
5548305	17526141	17526141	234	2023-02-10 00:07:35	2023-02-10 00:07:35
5548306	10822218	10822218	234	2023-02-10 00:07:46	2023-02-10 00:07:46
5548307	12604274	18027716	234	2023-02-10 00:07:46	2023-02-10 00:07:46
5548308	18027716	12604274	234	2023-02-10 00:07:55	2023-02-10 00:07:55
5548310	10822218	11243210	234	2023-02-10 00:07:56	2023-02-10 00:07:56
5548313	10736567	10736567	234	2023-02-10 00:08:00	2023-02-10 00:08:00
5548326	16923130	1932410	234	2023-02-10 00:08:52	2023-02-10 00:08:52
5548330	12032327	18250290	234	2023-02-10 00:08:59	2023-02-10 00:08:59
5548336	14830042	11823784	234	2023-02-10 00:09:07	2023-02-10 00:09:07
5548341	10736567	9460874	234	2023-02-10 00:09:39	2023-02-10 00:09:39
5548344	18519684	18519684	234	2023-02-10 00:09:55	2023-02-10 00:09:55
5548353	5085167	5085167	234	2023-02-10 00:10:19	2023-02-10 00:10:19
5548365	18325271	18325271	234	2023-02-10 00:10:47	2023-02-10 00:10:47
5548389	12032327	16773311	234	2023-02-10 00:12:13	2023-02-10 00:12:13
5548399	10822218	15773959	234	2023-02-10 00:12:53	2023-02-10 00:12:53
5548430	14287975	11790452	234	2023-02-10 00:15:06	2023-02-10 00:15:06
5548432	5085167	11629649	234	2023-02-10 00:15:18	2023-02-10 00:15:18
5548490	10143130	12284540	234	2023-02-10 00:20:59	2023-02-10 00:20:59
5548521	10736567	18279618	234	2023-02-10 00:24:05	2023-02-10 00:24:05
5548617	12961663	7546389	234	2023-02-10 00:32:31	2023-02-10 00:32:31
5548621	12961663	12961663	234	2023-02-10 00:32:56	2023-02-10 00:32:56
5548700	13532051	17007893	234	2023-02-10 00:42:24	2023-02-10 00:42:24
5548734	13532051	13532051	234	2023-02-10 00:46:29	2023-02-10 00:46:29
5549613	8925046	14492211	234	2023-02-10 07:14:14	2023-02-10 07:14:14
5549616	8925046	8925046	234	2023-02-10 07:14:55	2023-02-10 07:14:55
5549623	18146804	16847422	234	2023-02-10 07:19:42	2023-02-10 07:19:42
5549627	18146804	18146804	234	2023-02-10 07:20:06	2023-02-10 07:20:06
5550069	17183833	17183833	234	2023-02-10 10:19:01	2023-02-10 10:19:01
5550085	17183833	10478578	234	2023-02-10 10:23:45	2023-02-10 10:23:45
5550458	12591971	12591971	234	2023-02-10 11:32:31	2023-02-10 11:32:31
5551237	16941872	16941872	234	2023-02-10 12:07:53	2023-02-10 12:07:53
5551705	17833544	12715442	234	2023-02-10 12:31:09	2023-02-10 12:31:09
5553208	18325271	18707366	234	2023-02-10 14:33:41	2023-02-10 14:33:41







3584) "18519684"
3585) "17526141"
3586) "18325271"
3587) "12032327"
3588) "12961663"
3589) "14467334"
3590) "13198475"
3591) "5046791"
3592) "12604274"
3593) "5085167"
3594) "8925046"
3595) "13532051"
3596) "14287975"
3597) "10822218"
3598) "10650581"
3599) "10736567"
3600) "16923130"
3601) "16903336"
3602) "18707366"
3603) "14830042"
3604) "18146804"
3605) "18027716"
3606) "17183833"
3607) "11401244"
3608) "15529812"
3609) "10143130"
3610) "14713077"
3611) "10478578"
3612) "15631752"
3613) "4109018"
3614) "10238635"
```





### 3.6.70

##### 钻石货币体系

> - 聊天室送礼（钻石礼物）
>   - 送礼人 - 财富值增加3倍
>   - 收礼人 - 礼物价值/10*1.5
>   - 驻场
> - 家族送礼
>   - 送礼人
>   - 收礼人
> - 私信送礼
>   - 

##### 女神节活动

> - 入口（**首页banner入口、商城、送礼物、语音房、充值**）注意线上开放时间
> - 送礼逻辑
>   - 送礼人增加魅力值
>   - 专属礼物增加用户魅力值（仅婚礼房、家族和私信送礼不算**）
>   - 每达到7w魅力值（7w,14w…），用户可获得女神节专属头像框+进场特效+房间背景1天。【系统自动下发】小助手发一条私信
> - 奖励领取逻辑
>   - 每次领取一个（？？？？）
>   - 每达到15w魅力值（15w,30w…），用户可领取女神节专属“爆礼物/小戒指卡/大礼物”1个，该“爆礼物”有概率爆出”大戒指“戒指卡。用户手动单次领取后发放至背包，领取后有弹窗提示。
>     即达到15w魅力值时用户共可获得上述装扮各2天+“其领取的礼物”1个。
> - 首页
>   - 奖励信息配置
> - 排行榜
>   - 奖励下发



##### 钻石房驻场功能

设计：3月1号

> - 房主白名单
>
>   - 权限管理
>     - 只有房主、副房主可以设置驻场
>     - 驻场人数限制99
>     - 用户同时只能被设置成一个房间驻场
>
> - 驻场管理入口
>
>   - 驻场管理tab
>
> - 功能
>
>   - 基础功能搭建（房主驻场信息表、用户驻场信息表、用户流水表（收礼））
>   - 驻场设置、取消、列表
>   - 流水产生、流水列表
>     - 钻石礼物特殊处理
>
> - 后台
>
>   - 钻石厅管理页面
>     - uid+room_id、驻场人数、时间、操作人、操作时间
>   - 批量添加
>   - 资料卡、c.flri
>   - 驻场管理
>     - 增加、删除
>
> - 后台功能
>
>   - 列表
>   - 驻场增加、删除
>
> - 开发
>
>   - live.manager.base     分支：banyajie
>
>     - 驻场基础功能（设置、取消、列表）
>     - 后台接口
>     - 驻场流水
>
>   - live.voiceroom.logic  分支：banyajie
>
>     - 个人资料卡（房主权限、自己驻场状态）
>
>   - imcenter.room.logic  分支：banyajie
>
>     - c.flri（入口）
>
>     

##### 聊天室优化

> - 贵宾席
>
>   - 方案1：贵宾席单独拉取 vip等级v4及以上
>
>     - 后面列表中怎么处理，去重（客户端去重）
>
>     - 
>
> - 聊天室 - 贡献榜
>
>   - 显示当日（0点-24点）用户在该房间的送给房主&麦上用户的的总财富值；
>   - 1财富值=1贡献值；
>   - 排序：根据当日贡献数值倒序排列；
>   - 信息：头像+头像框+用户昵称+VIP等级+魅力值+性别
>   - 点击可进入用户资料页；
>
>   
>
>   - 当前房间的送礼榜？？（每日）
>     - 榜单数据生成
>     - api - 获取榜数据
>     - 变更事件
>       - 实时触发
>
> - 会员权益更新配置
>
> - 开发
>
>   - vip席位     -  live.room.base
>
>     - 下行
>       - sg_room_user_List
>         - 拉取vip用户列表是否变化，如果变化，更新下行
>     - 接口
>       - Live.voiceroom.logic
>         - 在线用户列表：SG_LIVE_ROOM_USER_LIST
>     - 底层接口
>       - imcenter.room.base           /service/v1/im/live_room/online_users/get（获取在线用户列表）- 
>
>   - 贡献榜 - 
>
>     - live.manager.base
>
>     - 下行
>
>       - ```go
>         sg_room_contribution_rank
>         
>         ```
>
>     - 接口
>
>       - 
>
>     - kafka
>
>       - 数据

##### vip优化

> - 新增两个vip等级配置

##### 其他

> - 通行证活动
> - 大转盘活动
> - 家族活跃调整
> - 风控场景
>   - 家族盲盒 - 长沙
>   - 家族任务 - 奖励领取
>   - 萌新接待 - 奖励领取
>   - 我的印记 - 奖励





> ```, 
> 300011, 310011
> ```





vip 席位

live.room.base 根据用户进房kafka判断



live.manager.base 

消费礼物 - 贡献榜



人脸

live.manager.base.    驻场设置判断

live.voiceroom.logic     开播事前



动态配置 - 入口

/banner          首页banner

/wishing/well/list     许愿池

/liveroom/more/conf     聊天室更多玩法







## 3.6.80

##### 亲密关系体系

- 入口、挚友展示规则
  - 主页：展示三个
  - 客态页
  - 聊天室 - 资料卡
- 挚友主页
  - cp位：cp双方头像+头像框+昵称+戒指+等级+天数（自己在左，cp在右）
  - 挚友位：挚友的头像+昵称+等级+关系+天数；
  - 等级：根据用户亲密值，达到等级；（详情查看等级规则）
  - 已解锁位置
- 挚友位置解锁
  - 解锁自己挚友位置
  - 解锁其他人挚友位置
  - 
- 绑定 - 创建关系
  - 邀请
    - 已关注列表（头像、昵称、亲密值、倒序），排除已绑定用户
    - 选择关系（关系、价格）
    - 对方是否有挚友位置
    - 提示
      - xxx
    - 发送私聊
      - xx
  - 处理邀请
    - 同意
      - 当对方还有挚友位时，绑定成功；关系双方收到对应的魅力值+财富值；
      - 当对方无挚友位时，弹出购买“挚友位”弹窗；
        - 购买后，绑定成功；
    - 拒绝
      - 很遗憾，「用户昵称」拒绝了你的「关系」绑定申请，钻石已退回到你的背包，请注意查收；
      - 并将虚拟币退还给发送方；
- 列表
  - 请求消息
  - 邀请消息
- 升级相关
  - 升级
  - 解锁
- 成就









支付宝 - 风控

- 联防开启
- time.expire
- 设备同盾 - 风控





/api/server/v1/user/dy_moment/base/moment/publish 文本+图片

```shell
/api/server/v1/user/dy_moment/base/moment/comment/publish   文本
/api/server/v1/user/dy_moment/base/moment/publish   文本+图片
/api/v1/sg/im/center/world_barrage/text/send   文本
/api/v1/socialgame/family/info  文本 + 图片
/api/v1/socialgame/send_msg/before   文本+图片
/api/server/v1/live/update/room/announcement 文本
/api/server/v1/live/update/room/cover 图片
/api/server/v1/live/send/msg   文本
/api/v1/sg/user/center/find_cp/declaration/create 文本
/api/v1/sg/user/center/find_cp/declaration/edit 文本
/api/v1/sg/user/follow/add 文本
/api/v1/sg/user/profile/update/before 文本
/hook/v2/sg/user/profile/update/before 文本
/api_server/v1/user/lovers/base/make_proposal 文本

```







关系

> 1：rank.center.base 批量获取守护值
>
> 2：