#### 本周工作

-   通行证上线
-   3.3.80需求梳理、反讲、排期



#### 3.3.80

###### 通行证赠送功能

>   -   首页入口 - 
>
>       -   赠送按钮、一键领取按钮调整
>       -   服务端判断是否有赠送功能
>
>   -   好友列表  - 老接口 
>
>   -   赠送好友
>
>       -   好友关系校验
>       -   对方数据校验，是否可赠送
>       -   赠送记录（datalog）?
>       -   赠送、支付成功后为好友解锁
>
>   -   赠送通知
>
>       -   im
>
>           
>
>   -   数据需求
>
>       -   赠送记录
>
>       
>
>   -   时间
>
>       -   开发、自测3天
>
>   -   上线
>
>       -   新增接口配置

###### 注销流程优化

>   -   注销老逻辑
>
>       -   绑定关系，注销频率限制、家族长、注销记录
>       -   注销账号、清理session、删除实名认证信息、撤销cp宣言、撤销cp申请
>
>   -   注销申请逻辑修改
>
>       -   事前校验（是否是家族长、）
>       -   注销记录生成（冷静期15天）- ***一个用户同时只有一个有效注销记录***
>       -   返回数据（文案。。。）
>
>   -   上下线逻辑
>
>       -   接收上线kafka，检测是否有有效注销记录，如果有注销申请，撤回注销申请
>       -   私信（你xxxx，欢迎回到xxxx）
>
>   -   注销
>
>       -   定时检查所有有效申请注销记录
>       -   注销账号、清理session、删除实名认证信息、撤销cp宣言、撤销cp申请
>
>       
>
>   -   时间
>
>       -   开发 自测 3 天
>
>   -   上线
>
>       -   db增加字段：state、sid
>       -   上线、

#### 3.3.90



>   -   会员特权二期
>       -   会员礼物（增加一个新的礼物墙。礼物墙接口拉取时判断用户vip等级..）
>       -   
>       -   会员礼物赠送指定礼物获得额外奖励 
>           -   赠送指定礼物，有概率获得额外的奖励（奖励类型：头像框、气泡框、主页特效、进场特效、戒指、礼物卡）（修改支持概率配置）
>           -   一个礼物对应一个奖励，概率为要么获得，要么不获得
>           -   送礼消息支持
>       -   会员商城
>           -   会员商城tab页
>           -   物品类别混合支持
>           -   物品支持判断购买资格（是否可购买、可购买条件标签、不可购买提示、）
>       
>   -   潘多拉魔盒支持
>       -   房主事件
>       
>           -   开播
>           -   关播
>       
>           ```go
>           // topic: nvwa_mediacenter_mediacenter_live_base_event_socialgame
>           
>           type LiveBaseKafkaMsg struct {
>           	Namespace       string      `json:"namespace"`    // socialgame
>           	Event           string      `json:"event"`		  // live.start（开播）、live.stop（关播）、live.expired（心跳过期关播）
>           	LiveID          string      `json:"live_id"`	  // 直播间ID
>           	Uid             int64       `json:"uid"`          // uid
>               Owner           int64       `json:"owner"`        // 当前主播 uid
>           	LiveType        string      `json:"live_type"`    // 
>           	Title           string      `json:"title"`        //  
>           	Cover           string      `json:"cover"`        //
>           	PubStat         int         `json:"pub_stat"`     // 
>           	Status          int         `json:"status"`       // 
>           	PublishAddr     string      `json:"publish_addr"` //
>           	StreamMixAddr   string      `json:"stream_mix_addr"`
>           	StreamMultiAddr string      `json:"stream_multi_addr"`
>           	StreamLinkAddr  string      `json:"stream_link_addr"`
>           	ShareAddr       string      `json:"share_addr"`
>           	LandScape       int         `json:"landscape"`
>           	StartTime       string      `json:"start_time"`
>           	StopTime        string      `json:"stop_time"`
>           	Longitude       string      `json:"longitude"`
>           	Latitude        string      `json:"latitude"`
>           	Location        string      `json:"location"`
>           	SlotID          int         `json:"slot_id"`  // 当前麦位
>           	SlotNum         int         `json:"slot_num"` // 麦个数
>           	Gender          int         `json:"gender"`   // 房主性别
>           	Extra           interface{} `json:"extra"`    // 扩展信息
>           }
>           ```
>       
>           
>       
>           -   房主转让
>       
>           ```go
>           // topic： nvwa_mediacenter_mediacenter_live_base_owner_set_event_socialgame
>           
>           type LiveOwnerSeKafkaMsg struct {
>           	Namespace string      `json:"namespace"`
>           	LiveID    string      `json:"live_id"`
>           	RoomID    string      `json:"room_id"`
>           	SlotID    int         `json:"slot_id"`
>               Uid       int64       `json:"uid"`        // 转让前房主uid   
>           	UidSlot   int         `json:"uid_slot"`   // 转让前房主slot
>           	Owner     int64       `json:"owner"`      // 当前房主uid
>           	OwnerSlot int         `json:"owner_slot"` // 当前房主slot
>           	LiveType  string      `json:"live_type"`
>           	Extra     interface{} `json:"extra"`
>           }
>           ```
>       
>           
>       
>   -   会员冰雪节活动
>       -   版本
>       -   入口 - banner
>       -   买一赠一
>       -   财富值加成
>       -   赠送好友
>       
>   -   聊天室挂件
>       
>       -   挂件触发（触发条件）
>           -   触发条件（特定礼物、红包...）可配置、时间可配置（挂件活动时间？？？）
>               -   活动触发场景
>               -   运营配置场景
>           -   挂件广播消息（推）
>           -   挂件信息拉取（拉 ）-  拉取挂件个数
>           -   挂件内容：图片、内容、支持的版本区间（是否可见）、用户是否可见条件、跳转地址.......
>           -   配置后台
>               -   活动时间、图片、内容、是否可见等等
>               -   挂件是否是多业务的 ？？（聊天室 - 游戏房间） -  设计多业务 
>               -   
>       -   基础服务搭建（挂件）
>           -   
>       
>   -   水族馆支持
>
>       -   商城

#### 3.4.00

###### 魅力榜一额外奖励

###### 红包

>   -   入口
>
>       -   礼物墙（聊天室礼物墙） -   客户端控制
>
>   -   购买（礼物红包）
>
>       -   红包额度信息
>           -   价值/额度（人民币、金币）、礼物名称（？）、礼物图片、礼物个数、文案
>       -   支付方式（金币、人民币）
>       -   是否有库存（本期不做） -   库存信息如何展示？？
>       -   人民币支付 - 商品配置
>           -   商品名称、红包个数、对应红包的 （红包配置ID - 所有红包配置在红包基础服务中）
>       -   发红包
>           -   金币方式 - 校验金币余额、扣减金币、发红包
>           -   人民币支付 - 购买订单、支付回调成功后 - 发红包（同步、异步）
>
>   -   红包基础服务
>
>       -   红包配置
>           -   
>       -   发红包
>           -   是否全站广播
>           -   是否使用库存（本期只支持基础逻辑）
>           -   挂件
>       -   领取红包
>           -   
>           -   挂件进度
>       -   红包被领取记录、top5
>       -   红包退款
>           -   倒计时
>           -   关播
>
>       

